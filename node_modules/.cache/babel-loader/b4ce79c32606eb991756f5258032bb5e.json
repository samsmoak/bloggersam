{"ast":null,"code":"import _regeneratorRuntime from\"/Users/samsmoaki/Desktop/tailwind projects/blogapp/api/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/samsmoaki/Desktop/tailwind projects/blogapp/api/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/samsmoaki/Desktop/tailwind projects/blogapp/api/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import{useState,useContext}from\"react\";import{Context}from\"../context/Context\";import API from\"./API\";import{CKEditor}from\"@ckeditor/ckeditor5-react\";import ClassicEditor from\"@ckeditor/ckeditor5-build-classic\";import parse from\"html-react-parser\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+File.name+\".png\";data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return API.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return API.post(\"/posts\",newPost);case 18:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:API.post(\"/posts\");case 25:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center mt-16 \".concat(!file&&\"h-big items-center\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5  \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-black col-span-3 col-start-2  flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full  rounded-2xl bg-greener-600\",children:file&&/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(file),alt:\"\",className:\"object-contain\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"w-full \",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{for:\"filetype\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus rounded-full p-1 border border-black\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"filetype\",className:\"hidden h-9 w-14 border border-black\",onChange:function onChange(e){setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"\",onChange:function onChange(e){setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-greener-300 px-7 py-2\",type:\"submit\",children:\"publish\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full\",children:/*#__PURE__*/_jsx(CKEditor,{editor:ClassicEditor,data:desc,onChange:function onChange(event,editor){var data=editor.getData();// const edt = parse(data);\nsetDesc(data);}})})]})})]})})});}export default Write;","map":{"version":3,"sources":["/Users/samsmoaki/Desktop/tailwind projects/blogapp/api/client/src/components/Write.js"],"names":["React","useState","useContext","Context","API","CKEditor","ClassicEditor","parse","Write","title","setTitle","file","setFile","desc","setDesc","user","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","File","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","target","files","value","event","editor","getData"],"mappings":"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","sourcesContent":["import React from \"react\";\n\nimport { useState, useContext } from \"react\";\nimport { Context } from \"../context/Context\";\nimport API from \"./API\";\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\nimport ClassicEditor from \"@ckeditor/ckeditor5-build-classic\";\nimport parse from \"html-react-parser\";\n\nfunction Write() {\n\tconst [title, setTitle] = useState(\"\");\n\tconst [file, setFile] = useState(null);\n\tconst [desc, setDesc] = useState(\"\");\n\tconst { user } = useContext(Context);\n\n\tconst handleSubmit = async (e) => {\n\t\te.preventDefault();\n\t\tconst newPost = {\n\t\t\tusername: user.username,\n\t\t\ttitle,\n\t\t\tdesc,\n\t\t};\n\t\tif (file) {\n\t\t\tconst data = new FormData();\n\t\t\tconst filename = Date.now() + File.name + \".png\";\n\t\t\tdata.append(\"name\", filename);\n\t\t\tdata.append(\"file\", file);\n\t\t\tnewPost.photo = filename;\n\n\t\t\ttry {\n\t\t\t\tawait API.post(\"/upload\", data);\n\t\t\t} catch (err) {}\n\t\t}\n\t\ttry {\n\t\t\tconst res = await API.post(\"/posts\", newPost);\n\t\t\twindow.location.replace(\"/post/\" + res.data._id);\n\t\t} catch (err) {}\n\t\tAPI.post(\"/posts\");\n\t};\n\n\treturn (\n\t\t<div\n\t\t\tclassName={`flex justify-center items-center mt-16 ${\n\t\t\t\t!file && \"h-big items-center\"\n\t\t\t}`}\n\t\t>\n\t\t\t<div className='grid grid-cols-5  '>\n\t\t\t\t<div className='text-black col-span-3 col-start-2  flex flex-col'>\n\t\t\t\t\t<div className='w-full  rounded-2xl bg-greener-600'>\n\t\t\t\t\t\t{file && (\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={URL.createObjectURL(file)}\n\t\t\t\t\t\t\t\talt=''\n\t\t\t\t\t\t\t\tclassName='object-contain'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=''>\n\t\t\t\t\t\t<form className={`w-full `} onSubmit={handleSubmit}>\n\t\t\t\t\t\t\t<div className='w-full flex justify-between'>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label for='filetype'>\n\t\t\t\t\t\t\t\t\t\t<i className='fas fa-plus rounded-full p-1 border border-black'></i>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\t\t\t\t\tid='filetype'\n\t\t\t\t\t\t\t\t\t\tclassName='hidden h-9 w-14 border border-black'\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\t\tsetFile(e.target.files[0]);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\tplaceholder='Title'\n\t\t\t\t\t\t\t\t\t\tclassName=''\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\t\tsetTitle(e.target.value);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<button className='bg-greener-300 px-7 py-2' type='submit'>\n\t\t\t\t\t\t\t\t\tpublish\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='w-full'>\n\t\t\t\t\t\t\t\t{/* <textarea\n\t\t\t\t\t\t\t\t\tplaceholder='write your story...'\n\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\tclassName='w-full h-32'\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\tsetDesc(e.target.value);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t></textarea> */}\n\t\t\t\t\t\t\t\t<CKEditor\n\t\t\t\t\t\t\t\t\teditor={ClassicEditor}\n\t\t\t\t\t\t\t\t\tdata={desc}\n\t\t\t\t\t\t\t\t\tonChange={(event, editor) => {\n\t\t\t\t\t\t\t\t\t\tlet data = editor.getData();\n\t\t\t\t\t\t\t\t\t\t// const edt = parse(data);\n\t\t\t\t\t\t\t\t\t\tsetDesc(data);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default Write;\n"]},"metadata":{},"sourceType":"module"}